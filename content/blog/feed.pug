---
layout: null
eleventyExcludeFromCollections: true

# Without the `dynamicPermalink` option, the `permalink` value would be parsed
# by Pug so that the value would be `_site/<blog/><feed class="xml"></feed>`.
# Huh! That would of course cause errors because that's not a valid path (at
# least on Windows). Another option would be to remove the `dynamicPermalink`
# option and change `permalink`'s value to `'| blog/feed.xml'`. More info:
# - https://www.11ty.dev/docs/permalinks/#disable-templating-in-permalinks
# - https://github.com/11ty/eleventy/issues/286
dynamicPermalink: false
permalink: blog/feed.xml

metadata:
  title: Blog â€“ Matias Kinnunen
  subtitle: A collection of my wildest adventures involving computers, cats and dragons. ðŸ±â€ðŸ‰
  siteUrl: https://mtsknn.fi/
  feedUrl: https://mtsknn.fi/blog/feed.xml
  author:
    name: Matias Kinnunen
    email: blog@mtsknn.fi
---
//- Blog posts don't have publication times, so let's just hard-code some value
- const get_updated_date = (date) => `${datetime.robot(date)}T12:00:00+03:00`

- const latest_post = collections.blog_posts[collections.blog_posts.length - 1]

doctype xml
feed(xmlns="http://www.w3.org/2005/Atom")
  title= metadata.title
  subtitle= metadata.subtitle
  link(href=metadata.feedUrl rel="self")
  link(href=metadata.siteUrl)
  updated= get_updated_date(latest_post.date)
  id= metadata.siteUrl
  author
    name= metadata.author.name
    email= metadata.author.email
  each post in collections.blog_posts
    - const full_url = `${metadata.siteUrl.replace(/\/$/, '')}${post.url}`
    entry
      title= post.data.title
      link(href=full_url)
      updated= get_updated_date(post.date)
      id= full_url
      content(type="html")
        = md.render(post.data.intro)
        = post.templateContent.replace(/<a class="link link-permalink".+<\/a>/g, '')
